<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Plan + Panoramor</title>

  <style>
    :root {
      --bg:#111;
      --panel:#0f0f0f;
      --panel2:#1a1a1a;
      --line:rgba(255,255,255,0.08);
      --txt:rgba(255,255,255,0.92);
      --txt2:rgba(255,255,255,0.65);
    }

    body {
      margin: 0;
      background: var(--bg);
      color: var(--txt);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }

    .wrap {
      max-width: 1200px;
      margin: 0 auto;
      padding: 18px;
    }

    h2 {
      margin: 0 0 12px;
      font-weight: 600;
    }

    /* ================= PLAN ================= */
    .plan {
      position: relative;
      width: 100%;
      aspect-ratio: 16 / 9;
      background: #000 url("plan.png") center / contain no-repeat;
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0,0,0,0.4);
    }

    /* ================= HOTSPOTS ================= */
    .hotspot {
      position: absolute;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      border: 2px solid rgba(255,255,255,0.95);
      background: rgba(0,0,0,0.35);
      transform: translate(-50%, -50%);
      cursor: pointer;
    }

    .hotspot::after {
      content: "";
      position: absolute;
      inset: 6px;
      border-radius: 50%;
      background: rgba(255,255,255,0.95);
    }

    .hotspot:hover {
      transform: translate(-50%, -50%) scale(1.1);
    }

    .hotspot.active {
      box-shadow: 0 0 0 6px rgba(255,255,255,0.12);
    }

    /* ================= HOVER CARD ================= */
    .tip {
      position: absolute;
      transform: translate(-50%, -115%);
      width: 220px;
      background: rgba(15,15,15,0.96);
      border: 1px solid var(--line);
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 18px 40px rgba(0,0,0,0.45);
      display: none;
      pointer-events: none;
      z-index: 5;
    }

    .tip img {
      width: 100%;
      height: 120px;
      object-fit: cover;
      display: block;
    }

    .tip .meta {
      padding: 10px 12px 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    .tip .title {
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .tip .hint {
      font-size: 12px;
      color: var(--txt2);
    }

    .tip::after {
      content: "";
      position: absolute;
      left: 50%;
      bottom: -8px;
      transform: translateX(-50%);
      width: 14px;
      height: 14px;
      background: rgba(15,15,15,0.96);
      border-right: 1px solid var(--line);
      border-bottom: 1px solid var(--line);
      rotate: 45deg;
    }

    /* ================= CAROUSEL ================= */
    .railWrap {
      margin-top: 14px;
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 12px;
      box-shadow: 0 14px 40px rgba(0,0,0,0.28);
    }

    .railHeader {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .railHeader .sub {
      font-size: 13px;
      color: var(--txt2);
    }

    .railControls {
      display: flex;
      gap: 8px;
    }

    .btn {
      border: 0;
      background: rgba(255,255,255,0.12);
      color: #fff;
      padding: 8px 10px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 14px;
    }

    .btn:hover {
      background: rgba(255,255,255,0.18);
    }

    .rail {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      scroll-behavior: smooth;
      padding-bottom: 6px;
    }

    .card {
      flex: 0 0 240px;
      background: var(--panel2);
      border: 1px solid var(--line);
      border-radius: 14px;
      overflow: hidden;
      cursor: pointer;
      transition: transform .12s ease;
    }

    .card:hover {
      transform: translateY(-2px);
    }

    .card img {
      width: 100%;
      height: 135px;
      object-fit: cover;
    }

    .card .cmeta {
      padding: 10px 12px 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .card .cname {
      font-size: 14px;
      font-weight: 650;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .card .ctag {
      font-size: 12px;
      color: var(--txt2);
    }

    /* ================= OVERLAY ================= */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.65);
      display: none;
      padding: 18px;
      box-sizing: border-box;
      z-index: 10;
    }

    .overlay.open {
      display: block;
    }

    .modal {
      width: min(1200px, 100%);
      height: min(760px, 100%);
      margin: 0 auto;
      background: #0f0f0f;
      border-radius: 14px;
      overflow: hidden;
      display: grid;
      grid-template-rows: 52px 1fr;
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 14px;
      background: #1a1a1a;
      border-bottom: 1px solid var(--line);
    }

    iframe {
      width: 100%;
      height: 100%;
      border: 0;
      background: #000;
    }
  </style>
</head>

<body>
<div class="wrap">
  <h2>Plan</h2>
  <div class="plan" id="plan"></div>

  <div class="railWrap">
    <div class="railHeader">
      <div>
        <div style="font-weight:650">Rum</div>
        <div class="sub">Klicka på ett rum för 360°</div>
      </div>
      <div class="railControls">
        <button class="btn" id="prevBtn">◀</button>
        <button class="btn" id="nextBtn">▶</button>
      </div>
    </div>
    <div class="rail" id="rail"></div>
  </div>
</div>

<div class="overlay" id="overlay">
  <div class="modal">
    <div class="modal-header">
      <span id="roomLabel"></span>
      <button class="btn" id="closeBtn">✕ Stäng</button>
    </div>
    <iframe id="viewerFrame"></iframe>
  </div>
</div>

<script>
  const rooms = [
    { name:"Entré", pano:"entre", hero:"HERO/hero_entre.png", top:"48%", left:"45%" },
    { name:"Kök", pano:"kok", hero:"HERO/hero_kok.png", top:"54%", left:"71%" },
    { name:"Kontor 1", pano:"kontor1", hero:"HERO/hero_kontor1.png", top:"70%", left:"82%" },
    { name:"Kontor 2", pano:"kontor2", hero:"HERO/hero_kontor2.png", top:"75%", left:"63%" },
    { name:"Mötesrum 1", pano:"motesrum1", hero:"HERO/hero_motesrum1.png", top:"78%", left:"37.5%" },
    { name:"Mötesrum 2", pano:"motesrum2", hero:"HERO/hero_motesrum2.png", top:"19%", left:"46.5%" },
    { name:"Teamsrum", pano:"teamsrum1", hero:"HERO/hero_teamsrum1.png", top:"80%", left:"48%" }
  ];

  const plan = document.getElementById("plan");
  const rail = document.getElementById("rail");
  const overlay = document.getElementById("overlay");
  const frame = document.getElementById("viewerFrame");
  const roomLabel = document.getElementById("roomLabel");

  function openRoom(room) {
    roomLabel.textContent = room.name;
    frame.src = `360viewer.html?pano=${room.pano}`;
    overlay.classList.add("open");
    document.querySelectorAll(".hotspot").forEach(h =>
      h.classList.toggle("active", h.dataset.pano === room.pano)
    );
  }

  function closeRoom() {
    overlay.classList.remove("open");
    frame.src = "";
    document.querySelectorAll(".hotspot").forEach(h => h.classList.remove("active"));
  }

  rooms.forEach(room => {
    const dot = document.createElement("button");
    dot.className = "hotspot";
    dot.style.top = room.top;
    dot.style.left = room.left;
    dot.dataset.pano = room.pano;

    const tip = document.createElement("div");
    tip.className = "tip";
    tip.innerHTML = `
      <img src="${room.hero}">
      <div class="meta">
        <div class="title">${room.name}</div>
        <div class="hint">Klicka</div>
      </div>`;
    dot.appendChild(tip);

    dot.addEventListener("mouseenter", () => tip.style.display = "block");
    dot.addEventListener("mouseleave", () => tip.style.display = "none");
    dot.addEventListener("click", () => openRoom(room));

    plan.appendChild(dot);

    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <img src="${room.hero}">
      <div class="cmeta">
        <div class="cname">${room.name}</div>
        <div class="ctag">360°</div>
      </div>`;
    card.addEventListener("click", () => openRoom(room));
    rail.appendChild(card);
  });

  document.getElementById("closeBtn").onclick = closeRoom;
  overlay.onclick = e => e.target === overlay && closeRoom();
  window.onkeydown = e => e.key === "Escape" && closeRoom();

  document.getElementById("prevBtn").onclick = () => rail.scrollBy({ left:-500, behavior:"smooth" });
  document.getElementById("nextBtn").onclick = () => rail.scrollBy({ left:500, behavior:"smooth" });
</script>
</body>
</html>
